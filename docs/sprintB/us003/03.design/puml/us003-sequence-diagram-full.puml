@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox
actor "System Administrator" as ADM
participant ":RegisterEmployeeUI" as UI
participant "controller\n:RegisterEmployeeController" as CTRL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as PLAT
participant "roleRepository\n:RoleRepository" as roleRepository
participant "employeeEmail\n:EmployeeEmail" as EMAIL
participant "agencyRepository\n:AgencyRepository" as AGENCY
participant "employeAddress\n:EmployeeAddress" as ADDRESS


activate ADM

        ADM -> UI : asks to register a new employee
            activate UI

            UI -> CTRL** : create()
            activate CTRL

                 CTRL -> RepositorySingleton : getInstance()
                                            activate RepositorySingleton

                                            RepositorySingleton --> CTRL: repositories
                                                deactivate RepositorySingleton

                                        CTRL -> PLAT : getAgencyRepository()
                                            activate PLAT

                                            PLAT --> CTRL: agencyRepository
                                                deactivate PLAT
                                                CTRL -> PLAT : getRoleRepository()
                                                                                    activate PLAT

                                                                                    PLAT --> CTRL: roleRepository
                                                                                        deactivate PLAT
            deactivate CTRL

        UI --> ADM : requestEmployeeData(employeeName, passaportCardNumber, \nemployeeTaxNumber, employeeEmail, empployeePhoneNumber)
            deactivate UI

        ADM -> UI : types requested data
            activate UI

UI --> ADM : requestEmployeeAddress(street, doorNumber, city, state, zipCode, country)
 ADM -> UI : types request data
 deactivate UI


        UI -> CTRL : getAgencies()
                    activate CTRL



                        CTRL -> AGENCY : getAgencies()
                            activate AGENCY

                            AGENCY --> CTRL : agencyList
                                deactivate AGENCY

                        CTRL --> UI : agencyList
                            deactivate CTRL

        UI --> ADM: shows agencies list and asks to select one
             deactivate UI

        ADM -> UI: selects the agency
            activate UI


        UI -> CTRL : getRoles()
                            activate CTRL





                                CTRL -> roleRepository : getRoles()
                                    activate roleRepository

                                    roleRepository --> CTRL : roleList
                                        deactivate roleRepository

                                CTRL --> UI : roleList
                                    deactivate CTRL

            UI --> ADM : shows roles list and asks to select one
        deactivate UI

    ADM -> UI : selects the role
        activate UI




UI -> CTRL : createEmployee(employeeName, passaportCardNumber, \nemployeeTaxNumber, employeeEmail, empployeePhoneNumber)
CTRL --> UI : Created employee
    UI --> ADM: shows all data and asks for a confirmation

deactivate UI

    ADM -> UI : confirms and submits data
    activate UI

        UI -> CTRL : resgisterEmployee(employeeName, passaportCardNumber, \nemployeeTaxNumber, employeeEmail, employeeAddress, empployeePhoneNumber, role, agency)
        activate CTRL

        CTRL -> EMAIL : sendEmailToUser(password)
                activate EMAIL


        CTRL --> UI : Employee
        deactivate CTRL



        UI --> ADM : Operation sucess
         deactivate UI
@enduml